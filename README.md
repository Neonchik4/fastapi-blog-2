# Мини-блог на FastAPI

Веб-приложение для создания и управления блогом с регистрацией, аутентификацией и авторизацией пользователей.

## Описание проекта

Приложение позволяет пользователям:
- Регистрироваться и авторизоваться в системе
- Создавать, редактировать и удалять блог-посты
- Сохранять посты как черновики
- Прикреплять теги к постам и фильтровать по тегам
- Ставить лайки постам
- Просматривать статистику блога
- Просматривать свой профиль и черновики

## Технологический стек

- **FastAPI** — веб-фреймворк
- **SQLAlchemy** — ORM с асинхронной поддержкой
- **aiosqlite** — асинхронный драйвер для SQLite
- **Alembic** — миграции базы данных
- **JWT** (python-jose) — аутентификация через токены
- **bcrypt** — хеширование паролей
- **Jinja2** — шаблонизатор
- **Pydantic** — валидация данных
- **Loguru** — логирование
- **Markdown2** — поддержка Markdown в постах

## Структура проекта

```
├── app/
│   ├── auth/                   # Модуль авторизации и аутентификации
│   │   ├── auth.py            # Логика JWT и работы с паролями
│   │   ├── dao.py             # DAO для работы с пользователями
│   │   ├── dependencies.py    # Зависимости для защиты эндпоинтов
│   │   ├── models.py          # Модели пользователей и ролей
│   │   ├── router.py          # Роутеры для регистрации и входа
│   │   └── schemas.py         # Схемы валидации
│   ├── api/                    # Модуль API блога
│   │   ├── dao.py             # DAO для работы с блогами и тегами
│   │   ├── likes_router.py    # API для лайков
│   │   ├── models.py          # Модели блогов и тегов
│   │   ├── router.py          # API эндпоинты блогов
│   │   └── schemas.py         # Схемы валидации
│   ├── pages/                  # Модуль фронтенд части
│   │   ├── router.py          # Роутеры страниц
│   │   └── views.py           # Представления страниц
│   ├── stats/                  # Модуль статистики
│   │   ├── router.py          # Роутеры статистики
│   │   └── service.py         # Логика статистики
│   ├── dao/                    # Базовые DAO
│   │   ├── base.py            # Базовый класс DAO
│   │   ├── database.py        # Подключение к БД
│   │   └── session_maker.py   # Создание сессий
│   ├── migration/              # Миграции Alembic
│   ├── static/                 # Статические файлы (CSS, JS)
│   ├── templates/              # HTML шаблоны
│   ├── config.py               # Конфигурация приложения
│   ├── exceptions.py           # Кастомные исключения
│   └── main.py                 # Точка входа приложения
├── data/                       # Файлы базы данных
├── tests/                      # Тесты
├── alembic.ini                 # Конфигурация Alembic
├── pyproject.toml              # Зависимости проекта
└── requirements.txt            # Зависимости проекта
```

## Установка

1. Клонируйте репозиторий:
   ```bash
   git clone <repository-url>
   cd FastApiBlog
   ```

2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```

3. Создайте файл `.env` в корне проекта:
   ```env
   SECRET_KEY=your_secret_key_here
   ALGORITHM=HS256
   ```

4. Примените миграции базы данных:
   ```bash
   alembic upgrade head
   ```

5. Запустите приложение:
   ```bash
   uvicorn app.main:app --reload
   ```
## Тестирование проекта

Перед запуском тестов убедитесь, что приложение запущено (см. пункт 5).
Для запуска тестов используйте pytest:

1. **Запуск всех тестов:**
   ```bash
   pytest
   ```

2. **Запуск тестов с подробным выводом:**
   ```bash
   pytest -v
   ```

3. **Запуск конкретного тестового файла:**
   ```bash
   pytest tests/test_auth_api.py
   ```

4. **Запуск тестов с покрытием кода (если установлен pytest-cov):**
   ```bash
   pytest --cov
   ```

5. **Запуск тестов в конкретной директории:**
   ```bash
   pytest tests/
   ```

Стоит отметить, что тесты запускаются в изолированной среде `/test_data/`.
Здесь собрано логирование всех тестов, а также база данных в, которой происходит тестирование.
Приложение будет доступно по адресу `http://127.0.0.1:8000` после запуска через `uvicorn`.
